<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Build Error Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            padding: 20px;
        }
        h1 { text-align: center; }
        .error { color: red; }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #eee;
        }
    </style>
</head>
<body>
    <h1>Build Error Report</h1>
    <h3>Build Info:</h3>
    <p><strong>Build Number:</strong> {{ build_number }}</p>
    <p><strong>Git Commit:</strong> {{ commit_id }}</p>
    

    <h3>Error Logs:</h3>
    {% if error_logs %}
        <ul>
        {% for error in error_logs %}
            <li class="error">{{ error }}</li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No errors found in this build.</p>
    {% endif %}
    
    <h3>Vulnerability Scan Results:</h3>

    {% if vulnerabilities %}
    <table>
        <thead>
            <tr class="header">
                <th>Target</th>
                <th>Package</th>
                <th>Installed Version</th>
                <th>Vulnerability ID</th>
                <th>Severity</th>
                <th>Title</th>
            </tr>
        </thead>
        <tbody>
        {% for vuln in vulnerabilities %}
            <tr>
                <td>{{ vuln.target }}</td>
                <td>{{ vuln.pkg_name }}</td>
                <td>{{ vuln.installed_version }}</td>
                <td>{{ vuln.vulnerability_id }}</td>
                <td class="{{ 'error' if vuln.severity in ['CRITICAL', 'HIGH'] else '' }}">{{ vuln.severity }}</td>
                <td>{{ vuln.title }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No vulnerabilities found.</p>
    {% endif %}
</body>
</html>
